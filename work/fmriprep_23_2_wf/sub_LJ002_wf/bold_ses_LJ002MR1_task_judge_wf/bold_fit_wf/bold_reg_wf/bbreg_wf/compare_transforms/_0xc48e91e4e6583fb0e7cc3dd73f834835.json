[
    [
        "function_str",
        "def compare_xforms(lta_list, norm_threshold=15):\n    \"\"\"\n    Computes a normalized displacement between two affine transforms as the\n    maximum overall displacement of the midpoints of the faces of a cube, when\n    each transform is applied to the cube.\n    This combines displacement resulting from scaling, translation and rotation.\n\n    Although the norm is in mm, in a scaling context, it is not necessarily\n    equivalent to that distance in translation.\n\n    We choose a default threshold of 15mm as a rough heuristic.\n    Normalized displacement above 20mm showed clear signs of distortion, while\n    \"good\" BBR refinements were frequently below 10mm displaced from the rigid\n    transform.\n    The 10-20mm range was more ambiguous, and 15mm chosen as a compromise.\n    This is open to revisiting in either direction.\n\n    See discussion in\n    `GitHub issue #681`_ <https://github.com/nipreps/fmriprep/issues/681>`_\n    and the `underlying implementation\n    <https://github.com/nipy/nipype/blob/56b7c81eedeeae884ba47c80096a5f66bd9f8116/nipype/algorithms/rapidart.py#L108-L159>`_.\n\n    Parameters\n    ----------\n\n      lta_list : :obj:`list` or :obj:`tuple` of :obj:`str`\n          the two given affines in LTA format\n      norm_threshold : :obj:`float`\n          the upper bound limit to the normalized displacement caused by the\n          second transform relative to the first (default: `15`)\n\n    \"\"\"\n    import nitransforms as nt\n    from nipype.algorithms.rapidart import _calc_norm_affine\n\n    bbr_affine = nt.linear.load(lta_list[0]).matrix\n    fallback_affine = nt.linear.load(lta_list[1]).matrix\n\n    norm, _ = _calc_norm_affine([fallback_affine, bbr_affine], use_differences=True)\n\n    return norm[1] > norm_threshold\n"
    ],
    [
        "lta_list",
        [
            [
                "/tmp/work/fmriprep_23_2_wf/sub_LJ002_wf/bold_ses_LJ002MR1_task_judge_wf/bold_fit_wf/bold_reg_wf/bbreg_wf/bbregister/sub-LJ002_ses-LJ002MR1_task-judge_desc-coreg_boldref_bbreg_sub-LJ002.lta",
                "62984c37ef234fb14e66e6ce84c80bdb"
            ],
            [
                "/tmp/work/fmriprep_23_2_wf/sub_LJ002_wf/bold_ses_LJ002MR1_task_judge_wf/bold_fit_wf/bold_reg_wf/bbreg_wf/mri_coreg/registration.lta",
                "42ef230c5c2d626d952d31a092388639"
            ]
        ]
    ],
    [
        "needed_outputs",
        [
            "out"
        ]
    ]
]